<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Yo {{user}}! Here's your path.</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      header { margin: 0; padding: 0;
			font-size: 15px;
			background: #8E44AD;
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			text-align: center;
			padding: 10px;
			color: #333;
			list-style-type: none;
			-webkit-font-smoothing: antialiased;
			text-rendering:optimizelegibility;
			}
    </style>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
    <script>
		function initialize() {
		var mainArray = {{main}};
		var maxLat = -1000
		var maxLong = -1000
		var minLat = 1000
		var minLong = 1000
		for (var i=0; i<(mainArray.length)-1; i++){
			minLat = (mainArray[i] < minLat) ? mainArray[i] : minLat;
			maxLat = (mainArray[i] < maxLat) ? mainArray[i] : maxLat;
			minLong = (mainArray[i+1] < minLong) ? mainArray[i+1] : minLong;
			maxLong = (mainArray[i+1] < maxLong) ? mainArray[i+1] : maxLong;
		}
		var centerLat = ((maxLat + minLat)/2)
		var centerLong = ((maxLong + minLong)/2)
		console.log(maxLat)
		console.log(maxLong);
		console.log(minLat);
		console.log(minLong);
		var myLatlng = new google.maps.LatLng(centerLat,centerLong);
		  var mapOptions = {
		    zoom: 5,
		    center: myLatlng
		  }
		 var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
		
		var markerArray = []
		var endIndex = mainArray.length-1
		var startPos = new google.maps.LatLng(mainArray[0],mainArray[1]);
		var endPos = new google.maps.LatLng(mainArray[endIndex-1],mainArray[endIndex]);

		markerArray.push(startPos);
		new google.maps.Marker({
		      position: startPos,
		      map: map,
		      title: 'Hello World!'
		  });
		for (var i=2; i<(mainArray.length)-3; i= i+2){
			if(mainArray[i]<minLat)
				minLat = mainArray[i]
			else if(mainArray[i]>maxLat)
				maxLat = mainArray[i]
			if(mainArray[i+1]<minLong)
				minLat = mainArray[i+1]
			else if(mainArray[i+1]>maxLong)
				maxLat = mainArray[i+1]
			var location = new google.maps.LatLng(mainArray[i],mainArray[i+1])
			markerArray.push(location)
			new google.maps.Marker({
		      position: location,
		      map: map,
		      title: 'Hello World!'
		  });
		}
		markerArray.push(endPos)
		new google.maps.Marker({
		      position: endPos,
		      map: map,
		      title: 'Hello World!'
		  });

		  var flightPlanCoordinates = markerArray
	  	var flightPath = new google.maps.Polyline({
	    path: flightPlanCoordinates,
	    geodesic: true,
	    strokeColor: '#FF0000',
	    strokeOpacity: 1.0,
	    strokeWeight: 2
	  });

  		flightPath.setMap(map);
		}

		google.maps.event.addDomListener(window, 'load', initialize);

    </script>
  </head>
 <body>
	<header>
  	<h1>Yo <span>{{user}}</span>! Here's your path.</h1>
	<ul>
		<li><span>Started:</span> {{start}}</li>
		<li><span>Finished:</span> {{end}}</li>
		<li><span>Time Elapsed:</span> {{elapsed}}</li>
	</ul>
  	</header>	

	<section id="map-canvas"></section>
</body>
</html>
